/*

highlight v4

Highlights arbitrary terms.

<http://johannburkard.de/blog/programming/javascript/highlight-javascript-text-higlighting-jquery-plugin.html>

MIT license.

Johann Burkard
<http://johannburkard.de>
<mailto:jb@eaio.com>

*/
jQuery.fn.highlight=function(a){function j(a,b){var e=0;if(3==a.nodeType){var d=a.data.toUpperCase().indexOf(b);if(0<=d){e=document.createElement("span");e.className="highlight";d=a.splitText(d);d.splitText(b.length);var f=d.cloneNode(!0);e.appendChild(f);d.parentNode.replaceChild(e,d);e=1}}else if(1==a.nodeType&&a.childNodes&&!/(script|style)/i.test(a.tagName))for(d=0;d<a.childNodes.length;++d)d+=j(a.childNodes[d],b);return e}a&&"string"===typeof a&&(a=[a]);return this.length&&a&&a.length?this.each(function(){var g=
$(this);"undefined"===typeof RegExp.quote&&(RegExp.quote=function(a){return String(a).replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")});var b="",e=[],d={},g=g.text(),f,c,h;for(c=0;c<a.length;++c)if(a[c]&&"*"!==a[c]){f="*"===a[c][0];h="*"===a[c][a[c].length-1];b="([\\s\\.,?!\\-\\/\"'<>\\(\\)\\{\\}])";b+="(";b+=f?"[^\\s\\.,?!\\-\\/\"'<>\\(\\)\\{\\}]*":"";b=f&&h?b+RegExp.quote(a[c].substr(1,a[c].length-2)):f?b+RegExp.quote(a[c].substr(1)):h?b+RegExp.quote(a[c].substr(0,a[c].length-1)):b+RegExp.quote(a[c]);
b+=h?".*?":"";b+=")";b+="([\\s\\.,?!\\-\\/\"'<>\\(\\)\\{\\}])";for(f=0;null!==(match=RegExp(b,"gi").exec(g.substr(f)));)f+=g.substr(f).indexOf(match[0])+match[0].length-1,e.push(match[2])}e.sort(function(a,b){return b.length-a.length});for(c=0;c<e.length;++c)d[e[c]]||(d[e[c]]=!0,j(this,e[c].toUpperCase(),!1))}):this};jQuery.fn.removeHighlight=function(){return this.find("span.highlight").each(function(){this.parentNode.replaceChild(this.firstChild,this);this.parentNode.normalize()}).end()};
